<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tRPC-Cpp: trpc::MQThreadPool Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tRPC-Cpp<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetrpc.html">trpc</a></li><li class="navelem"><a class="el" href="classtrpc_1_1_m_q_thread_pool.html">MQThreadPool</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a>  </div>
  <div class="headertitle"><div class="title">trpc::MQThreadPool Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The implementation of task-steal thread pool The difference between this class and <code><a class="el" href="classtrpc_1_1_s_q_thread_pool.html" title="The implementation of shared task queue thread pool usage:">SQThreadPool</a></code> is: this class there are two queues:  
 <a href="classtrpc_1_1_m_q_thread_pool.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mq__thread__pool_8h_source.html">mq_thread_pool.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc52398a056d82fc2629a6251e856bc9" id="r_afc52398a056d82fc2629a6251e856bc9"><td class="memItemLeft" align="right" valign="top"><a id="afc52398a056d82fc2629a6251e856bc9" name="afc52398a056d82fc2629a6251e856bc9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MQThreadPool</b> (<a class="el" href="structtrpc_1_1_thread_pool_option.html">ThreadPoolOption</a> &amp;&amp;thread_pool_option)</td></tr>
<tr class="separator:afc52398a056d82fc2629a6251e856bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f60e4bbcd247efa1cab4fc8bb87cdd5" id="r_a4f60e4bbcd247efa1cab4fc8bb87cdd5"><td class="memItemLeft" align="right" valign="top"><a id="a4f60e4bbcd247efa1cab4fc8bb87cdd5" name="a4f60e4bbcd247efa1cab4fc8bb87cdd5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetThreadInitFunc</b> (<a class="el" href="classtrpc_1_1_function.html">Function</a>&lt; void()&gt; &amp;&amp;func)</td></tr>
<tr class="memdesc:a4f60e4bbcd247efa1cab4fc8bb87cdd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set thread initialization function When the user needs to initialize a custom thread private variable for each worker thread, use this function. <br /></td></tr>
<tr class="separator:a4f60e4bbcd247efa1cab4fc8bb87cdd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215a97f43583b99216ce48a698254676" id="r_a215a97f43583b99216ce48a698254676"><td class="memItemLeft" align="right" valign="top"><a id="a215a97f43583b99216ce48a698254676" name="a215a97f43583b99216ce48a698254676"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>Start</b> ()</td></tr>
<tr class="memdesc:a215a97f43583b99216ce48a698254676"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the thread pool. <br /></td></tr>
<tr class="separator:a215a97f43583b99216ce48a698254676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e1ac8ed543895d3c3973f6f722f598" id="r_a55e1ac8ed543895d3c3973f6f722f598"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtrpc_1_1_m_q_thread_pool.html#a55e1ac8ed543895d3c3973f6f722f598">AddTask</a> (<a class="el" href="classtrpc_1_1_function.html">Function</a>&lt; void()&gt; &amp;&amp;job)</td></tr>
<tr class="memdesc:a55e1ac8ed543895d3c3973f6f722f598"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put a task into the thread pool.  <br /></td></tr>
<tr class="separator:a55e1ac8ed543895d3c3973f6f722f598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e352ac11de5ba96aabb17be3518d062" id="r_a3e352ac11de5ba96aabb17be3518d062"><td class="memItemLeft" align="right" valign="top"><a id="a3e352ac11de5ba96aabb17be3518d062" name="a3e352ac11de5ba96aabb17be3518d062"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Stop</b> ()</td></tr>
<tr class="memdesc:a3e352ac11de5ba96aabb17be3518d062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the thread pool. <br /></td></tr>
<tr class="separator:a3e352ac11de5ba96aabb17be3518d062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b4a455806d5f1ae346db1fd2dca633" id="r_a57b4a455806d5f1ae346db1fd2dca633"><td class="memItemLeft" align="right" valign="top"><a id="a57b4a455806d5f1ae346db1fd2dca633" name="a57b4a455806d5f1ae346db1fd2dca633"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Join</b> ()</td></tr>
<tr class="memdesc:a57b4a455806d5f1ae346db1fd2dca633"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for all threads to finish Empty implementation, the operation of waiting for thread finish has been implemented in <code>Stop</code> <br /></td></tr>
<tr class="separator:a57b4a455806d5f1ae346db1fd2dca633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5604bf8f018cbb87f00f38c21f1e8c86" id="r_a5604bf8f018cbb87f00f38c21f1e8c86"><td class="memItemLeft" align="right" valign="top"><a id="a5604bf8f018cbb87f00f38c21f1e8c86" name="a5604bf8f018cbb87f00f38c21f1e8c86"></a>
const <a class="el" href="structtrpc_1_1_thread_pool_option.html">ThreadPoolOption</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>GetThreadPoolOption</b> () const</td></tr>
<tr class="memdesc:a5604bf8f018cbb87f00f38c21f1e8c86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get thread pool option. <br /></td></tr>
<tr class="separator:a5604bf8f018cbb87f00f38c21f1e8c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7676b8501b9e5e13d61191730fea327" id="r_aa7676b8501b9e5e13d61191730fea327"><td class="memItemLeft" align="right" valign="top"><a id="aa7676b8501b9e5e13d61191730fea327" name="aa7676b8501b9e5e13d61191730fea327"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>IsStop</b> ()</td></tr>
<tr class="memdesc:aa7676b8501b9e5e13d61191730fea327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the thread pool is in terminated state. <br /></td></tr>
<tr class="separator:aa7676b8501b9e5e13d61191730fea327"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a6cf63c46b3ce270a5ebeb025a6d5bff8" id="r_a6cf63c46b3ce270a5ebeb025a6d5bff8"><td class="memItemLeft" align="right" valign="top"><a id="a6cf63c46b3ce270a5ebeb025a6d5bff8" name="a6cf63c46b3ce270a5ebeb025a6d5bff8"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>kTaskQueueSize</b> = 10000</td></tr>
<tr class="separator:a6cf63c46b3ce270a5ebeb025a6d5bff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The implementation of task-steal thread pool The difference between this class and <code><a class="el" href="classtrpc_1_1_s_q_thread_pool.html" title="The implementation of shared task queue thread pool usage:">SQThreadPool</a></code> is: this class there are two queues: </p>
<ol type="1">
<li>shared task queue</li>
<li>thread local queue Tasks submitted by threads outside the thread pool are submitted to the shared queue, and all threads in the thread pool can take tasks from it for execution. The tasks produced in the threads in the thread pool are submitted to their own local private queues, when other threads are idle, they can get tasks from the shared queue, or steal tasks from the queues of other threads.</li>
</ol>
<p>usage:</p>
<p><a class="el" href="structtrpc_1_1_thread_pool_option.html" title="Thread pool initialization parameters.">trpc::ThreadPoolOption</a> thread_pool_option; thread_pool_option.thread_num = 2; <a class="el" href="classtrpc_1_1_m_q_thread_pool.html" title="The implementation of task-steal thread pool The difference between this class and SQThreadPool is: t...">trpc::MQThreadPool</a> thread_pool(std::move(thread_pool_option)); thread_pool.Start(); thread_pool.PushTask([]()); thread_pool.Stop(); </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a55e1ac8ed543895d3c3973f6f722f598" name="a55e1ac8ed543895d3c3973f6f722f598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55e1ac8ed543895d3c3973f6f722f598">&#9670;&#160;</a></span>AddTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool trpc::MQThreadPool::AddTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrpc_1_1_function.html">Function</a>&lt; void()&gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>job</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Put a task into the thread pool. </p>
<dl class="section return"><dt>Returns</dt><dd>true: success, false: failed(the reason is that the queue is full) </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>trpc/util/thread/<a class="el" href="mq__thread__pool_8h_source.html">mq_thread_pool.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 10 2023 16:03:03 for tRPC-Cpp by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>

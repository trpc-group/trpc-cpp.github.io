<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tRPC-Cpp: trpc::HeartBeatReport Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tRPC-Cpp<span id="projectnumber">&#160;1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetrpc.html">trpc</a></li><li class="navelem"><a class="el" href="classtrpc_1_1_heart_beat_report.html">HeartBeatReport</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">trpc::HeartBeatReport Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This singleton class is used for service and thread heartbeat reporting, it includes the following features:  
 <a href="classtrpc_1_1_heart_beat_report.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="heartbeat__report_8h_source.html">heartbeat_report.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a8c2580bbfe33d1c6237b44d1a3826e69" id="r_a8c2580bbfe33d1c6237b44d1a3826e69"><td class="memItemLeft" align="right" valign="top"><a id="a8c2580bbfe33d1c6237b44d1a3826e69" name="a8c2580bbfe33d1c6237b44d1a3826e69"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>ServiceReportFunction</b> = <a class="el" href="classtrpc_1_1_function.html">Function</a>&lt; void(const std::string &amp;, const <a class="el" href="structtrpc_1_1_service_heart_beat_info.html">ServiceHeartBeatInfo</a> &amp;)&gt;</td></tr>
<tr class="memdesc:a8c2580bbfe33d1c6237b44d1a3826e69"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classtrpc_1_1_function.html" title="Note that although some of the implementation of std::function&lt;...&gt; (including libstdc++,...">Function</a> to report heartbeat to the naming service. <br /></td></tr>
<tr class="separator:a8c2580bbfe33d1c6237b44d1a3826e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d0f5cba7320dfe480ba5b5400728ce7" id="r_a6d0f5cba7320dfe480ba5b5400728ce7"><td class="memItemLeft" align="right" valign="top"><a id="a6d0f5cba7320dfe480ba5b5400728ce7" name="a6d0f5cba7320dfe480ba5b5400728ce7"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>ReportToMetricsFunction</b> = <a class="el" href="classtrpc_1_1_function.html">Function</a>&lt; void(const ThreadHeartBeatInfo &amp;)&gt;</td></tr>
<tr class="memdesc:a6d0f5cba7320dfe480ba5b5400728ce7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classtrpc_1_1_function.html" title="Note that although some of the implementation of std::function&lt;...&gt; (including libstdc++,...">Function</a> to report heartbeat information to monitor, only used to report queue size currently. <br /></td></tr>
<tr class="separator:a6d0f5cba7320dfe480ba5b5400728ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6cd6201b544658927eacabc77cd2495c" id="r_a6cd6201b544658927eacabc77cd2495c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtrpc_1_1_heart_beat_report.html#a6cd6201b544658927eacabc77cd2495c">SetServerHeartBeatReportSwitch</a> (bool report_switch)</td></tr>
<tr class="memdesc:a6cd6201b544658927eacabc77cd2495c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to set whether to perform server-level heartbeat reporting.  <br /></td></tr>
<tr class="separator:a6cd6201b544658927eacabc77cd2495c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7a64ac3d867628121825f2d282679f" id="r_abb7a64ac3d867628121825f2d282679f"><td class="memItemLeft" align="right" valign="top"><a id="abb7a64ac3d867628121825f2d282679f" name="abb7a64ac3d867628121825f2d282679f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>IsNeedReportServerHeartBeat</b> ()</td></tr>
<tr class="memdesc:abb7a64ac3d867628121825f2d282679f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get value of server-level heartbeat reporting switch. <br /></td></tr>
<tr class="separator:abb7a64ac3d867628121825f2d282679f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919f5f3ada174bbea427eba4bcb24727" id="r_a919f5f3ada174bbea427eba4bcb24727"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtrpc_1_1_heart_beat_report.html#a919f5f3ada174bbea427eba4bcb24727">SetServiceHeartBeatReportSwitch</a> (const std::string &amp;service_name, bool report_switch)</td></tr>
<tr class="memdesc:a919f5f3ada174bbea427eba4bcb24727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to set whether to perform service-level heartbeat reporting.  <br /></td></tr>
<tr class="separator:a919f5f3ada174bbea427eba4bcb24727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852c38aa6e44ab810e7d62abb408b3c5" id="r_a852c38aa6e44ab810e7d62abb408b3c5"><td class="memItemLeft" align="right" valign="top"><a id="a852c38aa6e44ab810e7d62abb408b3c5" name="a852c38aa6e44ab810e7d62abb408b3c5"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>IsNeedReportServiceHeartBeat</b> (const std::string &amp;service_name)</td></tr>
<tr class="memdesc:a852c38aa6e44ab810e7d62abb408b3c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get value of service-level heartbeat reporting switch by service name. <br /></td></tr>
<tr class="separator:a852c38aa6e44ab810e7d62abb408b3c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444be54d4f29ff58e377318e554e8f31" id="r_a444be54d4f29ff58e377318e554e8f31"><td class="memItemLeft" align="right" valign="top"><a id="a444be54d4f29ff58e377318e554e8f31" name="a444be54d4f29ff58e377318e554e8f31"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetHeartBeatReportFunction</b> (<a class="el" href="classtrpc_1_1_heart_beat_report.html#a8c2580bbfe33d1c6237b44d1a3826e69">ServiceReportFunction</a> &amp;&amp;func)</td></tr>
<tr class="memdesc:a444be54d4f29ff58e377318e554e8f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set function that used for report heartbeat information to the naming service. <br /></td></tr>
<tr class="separator:a444be54d4f29ff58e377318e554e8f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939d4acae1b6b331e7748aca5d7cbaa0" id="r_a939d4acae1b6b331e7748aca5d7cbaa0"><td class="memItemLeft" align="right" valign="top"><a id="a939d4acae1b6b331e7748aca5d7cbaa0" name="a939d4acae1b6b331e7748aca5d7cbaa0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetReportMetricFunction</b> (<a class="el" href="classtrpc_1_1_heart_beat_report.html#a6d0f5cba7320dfe480ba5b5400728ce7">ReportToMetricsFunction</a> &amp;&amp;func)</td></tr>
<tr class="memdesc:a939d4acae1b6b331e7748aca5d7cbaa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set function that used for report statistical data to the metrics service. <br /></td></tr>
<tr class="separator:a939d4acae1b6b331e7748aca5d7cbaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7fd6d4f2eefa7595327ac515b86d290c" id="r_a7fd6d4f2eefa7595327ac515b86d290c"><td class="memItemLeft" align="right" valign="top"><a id="a7fd6d4f2eefa7595327ac515b86d290c" name="a7fd6d4f2eefa7595327ac515b86d290c"></a>
static <a class="el" href="classtrpc_1_1_heart_beat_report.html">HeartBeatReport</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>GetInstance</b> ()</td></tr>
<tr class="memdesc:a7fd6d4f2eefa7595327ac515b86d290c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get singleton instance. <br /></td></tr>
<tr class="separator:a7fd6d4f2eefa7595327ac515b86d290c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This singleton class is used for service and thread heartbeat reporting, it includes the following features: </p>
<ol type="1">
<li>Timely report the service heartbeat to the naming service. Note: Use 'RegistryServiceHeartBeatInfo' interface to register the heartbeat information that needs to be reported when the service is initialized. And then the heartbeat reporting task will periodically report to the naming service though the function set by 'SetHeartBeatReportFunction' interface.</li>
<li>Detect whether the 'Handle' thread is dead in separate thread model during runtime. Note: The 'Handle' thread reports its heartbeat every 3 seconds though 'ThreadHeartBeat' interface. The heartbeat reporting task will periodically check whether the heartbeat has been reported within the threshold. If it has not been reported for a long time, the thread is considered dead. When all 'Handle' threads are detected to be dead, then the heartbeat reporting of the service will be stopped.</li>
<li>Report the task queue size of 'IO' or 'Handle' thread to the metrics system. Note: The 'IO' or 'Handle' threads will report their own queue size in real-time through 'ThreadHeartBeat' interface. </li>
</ol>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6cd6201b544658927eacabc77cd2495c" name="a6cd6201b544658927eacabc77cd2495c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd6201b544658927eacabc77cd2495c">&#9670;&#160;</a></span>SetServerHeartBeatReportSwitch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trpc::HeartBeatReport::SetServerHeartBeatReportSwitch </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>report_switch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to set whether to perform server-level heartbeat reporting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">report_switch</td><td>true: reporting, false: not report </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a919f5f3ada174bbea427eba4bcb24727" name="a919f5f3ada174bbea427eba4bcb24727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919f5f3ada174bbea427eba4bcb24727">&#9670;&#160;</a></span>SetServiceHeartBeatReportSwitch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trpc::HeartBeatReport::SetServiceHeartBeatReportSwitch </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>service_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>report_switch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to set whether to perform service-level heartbeat reporting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">report_switch</td><td>true: reporting, false: not report </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>trpc/runtime/common/heartbeat/<a class="el" href="heartbeat__report_8h_source.html">heartbeat_report.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 28 2023 11:25:47 for tRPC-Cpp by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
